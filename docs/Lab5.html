<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 5: Spatial Data Processing with Vector and Raster Data</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">SPH 215: GIS and Public Health Spring 2025</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Syllabus.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lab1.html">Lab 1: Intro to R</a>
    </li>
    <li>
      <a href="Lab2.html">Lab 2: Geocoding, Vector Data, and Census Data </a>
    </li>
    <li>
      <a href="Lab3.html">Lab 3: Polygons and Rasters</a>
    </li>
    <li>
      <a href="Lab4.html">Lab 4: Spatial Data Processing with Vector Data</a>
    </li>
    <li>
      <a href="Lab5.html">Lab 5: Spatial Data Processing with Vector and Raster Data</a>
    </li>
    <li>
      <a href="Lab6.html">Lab 6: Network Analysis</a>
    </li>
    <li>
      <a href="Lab7.html">Lab 7: Spatial Statistics</a>
    </li>
    <li>
      <a href="Lab8.html">Lab 8: Geographically Weighted Regression</a>
    </li>
    <li>
      <a href="Lab9.html">Lab 9: Future Directions in GIS and Public Health</a>
    </li>
  </ul>
</li>
<li>
  <a href="Assignments.html">Assignment Guide</a>
</li>
<li>
  <a href="Other.html">Data Sources</a>
</li>
<li>
  <a href="R_help.html">Help with R</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lab 5: Spatial Data Processing with Vector
and Raster Data</h1>

</div>


<p><br />
</p>
<p>In this lab, we are going to work with vector and raster data,
spatially joining point data to vector data</p>
<p>The objectives of this guide are to teach you:</p>
<ol style="list-style-type: decimal">
<li>Import our dataset with simulated geocoded addresses and mortality
data from an ovarian cancer cohort</li>
<li>Import a dataset with greenspace across the Bay Area</li>
<li>Compare projections of datasets and re-project if needed</li>
<li>Make maps</li>
<li>Spatially join the two datasets</li>
<li>Run a quick statistical analysis on the two datasets combined</li>
</ol>
<p>Enough talk–let’s get coding!</p>
<p><br />
</p>
<div id="install-packages" class="section level1">
<h1>Install packages</h1>
<p>First, let’s install our packages.</p>
<pre class="r"><code>library(sf)</code></pre>
<pre><code>## Linking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE</code></pre>
<pre class="r"><code>library(MapGAM)</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## Loading required package: gam</code></pre>
<pre><code>## Loading required package: splines</code></pre>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loaded gam 1.22-5</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.2     ✔ tibble    3.2.1
## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
## ✔ purrr     1.0.4</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ purrr::accumulate() masks foreach::accumulate()
## ✖ dplyr::filter()     masks stats::filter()
## ✖ dplyr::lag()        masks stats::lag()
## ✖ purrr::when()       masks foreach::when()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<pre class="r"><code>library(flextable)</code></pre>
<pre><code>## 
## Attaching package: &#39;flextable&#39;
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     compose</code></pre>
<pre class="r"><code>library(RColorBrewer)
library(tmap)
library(terra)</code></pre>
<pre><code>## terra 1.8.29
## 
## Attaching package: &#39;terra&#39;
## 
## The following objects are masked from &#39;package:flextable&#39;:
## 
##     align, colorize, rotate, width
## 
## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<p><br />
</p>
</div>
<div id="bring-in-cancer-dataset" class="section level1">
<h1>Bring in Cancer dataset</h1>
<p>We will be using data included in the <strong>MapGAM</strong> <a
href="https://cran.r-project.org/web/packages/MapGAM/MapGAM.pdf">package</a>.
As a reminder: While they are based on real patterns expected in
observational epidemiologic studies, these data have been simulated and
are for teaching purposes only. The data contain 5000 simulated ovarian
cancer cases. While this is a cohort with time to mortality, for the
purposes of our class, we will conduct simple tabular analyses looking
at associations between different spatial exposures with mortality at
end of follow-up.</p>
<p>As another reminder, the <em>CAdata</em> dataset contains the
following variables:</p>
<ul>
<li>time (follow-up time)</li>
<li>event (1=dead, 0=censored)</li>
<li>X (Latitude)</li>
<li>Y (Longitude)</li>
<li>AGE (age in years)</li>
<li>INS (insurance status, categorical)</li>
</ul>
<p><br />
</p>
<div id="read-in-cancer-dataset" class="section level2">
<h2>Read in Cancer Dataset</h2>
<p>Next, we want to read in all of our spatial data. First, we read in
the <em>CAdata</em> dataset from the <strong>MapGAM</strong> package,
and then convert it to a spatial dataset.</p>
<pre class="r"><code>data(CAdata)
ca_pts &lt;- CAdata
ca_proj &lt;- &quot;+proj=lcc +lat_1=40 +lat_2=41.66666666666666 
             +lat_0=39.33333333333334 +lon_0=-122 +x_0=2000000 
             +y_0=500000.0000000002 +ellps=GRS80 
             +datum=NAD83 +units=m +no_defs&quot;

ca_pts &lt;- st_as_sf(CAdata, coords=c(&quot;X&quot;,&quot;Y&quot;), crs=ca_proj)</code></pre>
<p><br />
</p>
</div>
<div id="read-in-greenspace-data" class="section level2">
<h2>Read in Greenspace Data</h2>
<p>We then read in the raster for greenspace data across the Bay Area.
Finally, we check the file to make sure it was read correctly. Does it
have a coordinate reference system?</p>
<pre class="r"><code>url &lt;- &quot;https://github.com/pjames-ucdavis/SPH215/raw/main/NDVI_rast2.tif&quot;
download.file(url, destfile = &quot;NDVI_rast2.tif&quot;, mode = &quot;wb&quot;)
ndvi_rast = rast(&quot;NDVI_rast2.tif&quot;)

ndvi_rast</code></pre>
<pre><code>## class       : SpatRaster 
## dimensions  : 1856, 1485, 1  (nrow, ncol, nlyr)
## resolution  : 0.0002694946, 0.0002694946  (x, y)
## extent      : -122.6001, -122.1999, 37.59988, 38.10007  (xmin, xmax, ymin, ymax)
## coord. ref. : lon/lat WGS 84 (EPSG:4326) 
## source      : NDVI_rast2.tif 
## name        : NDVI_BayArea 
## min value   :   -1.0000000 
## max value   :    0.8533574</code></pre>
<p><br />
</p>
</div>
</div>
<div id="check-projections-for-all-spatial-data" class="section level1">
<h1>Check Projections for all Spatial Data</h1>
<p>Finally, we check the projections. <strong>This is the most important
step and is guaranteed to make life easier with your geospatial
analysis!</strong> When you have files in different projections, this
can be a major problem because when we try to overlay the two files they
may not overlap. First we check the coordinate reference systems for
each dataset using <code>st_crs()</code>. We then use the
<code>st_transform()</code> function to convert the projection for our
point data to match that of our polygon data. When we are done, do the
projections of the two datasets match?</p>
<pre class="r"><code>## Look at the coordinate reference system for the cancer data, and for greenspace data
st_crs(ca_pts)</code></pre>
<pre><code>## Coordinate Reference System:
##   User input: +proj=lcc +lat_1=40 +lat_2=41.66666666666666 
##              +lat_0=39.33333333333334 +lon_0=-122 +x_0=2000000 
##              +y_0=500000.0000000002 +ellps=GRS80 
##              +datum=NAD83 +units=m +no_defs 
##   wkt:
## PROJCRS[&quot;unknown&quot;,
##     BASEGEOGCRS[&quot;unknown&quot;,
##         DATUM[&quot;North American Datum 1983&quot;,
##             ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 LENGTHUNIT[&quot;metre&quot;,1]],
##             ID[&quot;EPSG&quot;,6269]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8901]]],
##     CONVERSION[&quot;unknown&quot;,
##         METHOD[&quot;Lambert Conic Conformal (2SP)&quot;,
##             ID[&quot;EPSG&quot;,9802]],
##         PARAMETER[&quot;Latitude of false origin&quot;,39.3333333333333,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8821]],
##         PARAMETER[&quot;Longitude of false origin&quot;,-122,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8822]],
##         PARAMETER[&quot;Latitude of 1st standard parallel&quot;,40,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8823]],
##         PARAMETER[&quot;Latitude of 2nd standard parallel&quot;,41.6666666666667,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8824]],
##         PARAMETER[&quot;Easting at false origin&quot;,2000000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8826]],
##         PARAMETER[&quot;Northing at false origin&quot;,500000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8827]]],
##     CS[Cartesian,2],
##         AXIS[&quot;(E)&quot;,east,
##             ORDER[1],
##             LENGTHUNIT[&quot;metre&quot;,1,
##                 ID[&quot;EPSG&quot;,9001]]],
##         AXIS[&quot;(N)&quot;,north,
##             ORDER[2],
##             LENGTHUNIT[&quot;metre&quot;,1,
##                 ID[&quot;EPSG&quot;,9001]]]]</code></pre>
<pre class="r"><code>st_crs(ndvi_rast)</code></pre>
<pre><code>## Coordinate Reference System:
##   User input: WGS 84 
##   wkt:
## GEOGCRS[&quot;WGS 84&quot;,
##     ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,
##         MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G2296)&quot;],
##         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
##             LENGTHUNIT[&quot;metre&quot;,1]],
##         ENSEMBLEACCURACY[2.0]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS[&quot;geodetic latitude (Lat)&quot;,north,
##             ORDER[1],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         AXIS[&quot;geodetic longitude (Lon)&quot;,east,
##             ORDER[2],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     USAGE[
##         SCOPE[&quot;Horizontal component of 3D system.&quot;],
##         AREA[&quot;World.&quot;],
##         BBOX[-90,-180,90,180]],
##     ID[&quot;EPSG&quot;,4326]]</code></pre>
<pre class="r"><code>## Transform the coordinate reference system of the cancer data to match that 
## of the greenspace  data
ca_transformed &lt;-st_transform(ca_pts, st_crs(ndvi_rast))  

## Check projections
st_crs(ndvi_rast)==st_crs(ca_transformed)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p><br />
</p>
</div>
<div id="map-the-data" class="section level1">
<h1>Map The Data</h1>
<p>Now, we will visualize our spatial data using <strong>tmap</strong>.
We will overlay the greenspace maps with the ovarian cancer data. Do any
patterns jump out, or are there any participants living in the middle of
the Bay?</p>
<pre class="r"><code>ca.ndvi.map &lt;- tm_shape(ndvi_rast) +
  tm_raster(style = &quot;cont&quot;) +
      tm_shape(ca_transformed) +
        tm_dots(size=0.25, alpha=0.8, col=&quot;blue&quot;)</code></pre>
<pre><code>## </code></pre>
<pre><code>## ── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
<pre><code>## [v3-&gt;v4] `tm_raster()`: instead of `style = &quot;cont&quot;`, use col.scale =
## `tm_scale_continuous()`.
## [v3-&gt;v4] `tm_dots()`: use &#39;fill&#39; for the fill color of polygons/symbols
## (instead of &#39;col&#39;), and &#39;col&#39; for the outlines (instead of &#39;border.col&#39;).
## [v3-&gt;v4] `tm_dots()`: use `fill_alpha` instead of `alpha`.</code></pre>
<pre class="r"><code>ca.ndvi.map</code></pre>
<pre><code>## Variable(s) &quot;col&quot; contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full range of visual values.</code></pre>
<p><img src="Lab5_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><br />
</p>
<p>We find that the most least green areas are in the downtown areas of
San Francisco and Oakland, which makes sense. Our cancer cohort data
overlaps with the greenspace map, which is reassuring.</p>
<p><br />
</p>
</div>
<div id="extract-raster-values-to-points" class="section level1">
<h1>Extract Raster Values to Points</h1>
<p>Now that we have visualized our data, let’s see if there is an
association between greenspace exposure and mortality among ovarian
cancer cases. We will first extract the values for greenspace to the
cancer dataset (merge the two datasets based on location of cases and
the greenspace pixel that they are in) using
<code>terra::extract</code>. Then we will check the distribution of
greenspace exposure in our cancer cases. We will use a two-sided
chi-squared test to test our hypothesis of the association between
greenspace exposure and mortality among ovarian cancer cases. What do we
find?</p>
<pre class="r"><code>## Spatially join the cancer point data to the walkability polygon data
ndvi_cancer = data.frame(ca_transformed,terra::extract(ndvi_rast, ca_transformed))
glimpse(ndvi_cancer) </code></pre>
<pre><code>## Rows: 5,000
## Columns: 7
## $ time         &lt;dbl&gt; 1.2759763, 4.2121775, 0.2074870, 3.5099074, 10.2977017, 4…
## $ event        &lt;dbl&gt; 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, …
## $ AGE          &lt;int&gt; 67, 56, 67, 69, 75, 59, 62, 39, 68, 72, 78, 79, 46, 77, 6…
## $ INS          &lt;fct&gt; Mcr, Mcd, Mng, Mcr, Mng, Mcr, Oth, Uni, Uni, Uni, Mcr, Mn…
## $ geometry     &lt;POINT [°]&gt; POINT (-122.3492 38.3025), POINT (-118.0174 34.1437…
## $ ID           &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…
## $ NDVI_BayArea &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.2483448…</code></pre>
<pre class="r"><code>## Take a look at a summary of the values
summary(ndvi_cancer$NDVI_BayArea)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##  -0.311   0.123   0.239   0.267   0.376   0.757    4688</code></pre>
<p><br />
</p>
<p>Looks like we have lots of NA values. That is because some of our
participants live outside of the area of our greenspace data. Let’s drop
those missing values using <code>drop_na()</code>, which is slightly
different from how we’ve done this before.</p>
<pre class="r"><code>ndvi_cancer_nomiss &lt;- ndvi_cancer %&gt;% drop_na(NDVI_BayArea) 

## Take a look at a summary of the values
summary(ndvi_cancer_nomiss$NDVI_BayArea)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -0.3107  0.1228  0.2385  0.2666  0.3759  0.7572</code></pre>
<pre class="r"><code>glimpse(ndvi_cancer_nomiss)</code></pre>
<pre><code>## Rows: 312
## Columns: 7
## $ time         &lt;dbl&gt; 7.0125318, 0.9644371, 15.0007229, 2.9063815, 16.7471545, …
## $ event        &lt;dbl&gt; 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, …
## $ AGE          &lt;int&gt; 46, 69, 45, 78, 72, 73, 77, 72, 46, 61, 79, 54, 78, 60, 7…
## $ INS          &lt;fct&gt; Mcr, Unk, Mcd, Mcr, Mng, Mcr, Mng, Mcr, Oth, Uni, Mcr, Un…
## $ geometry     &lt;POINT [°]&gt; POINT (-122.2031 38.09592), POINT (-122.416 37.7678…
## $ ID           &lt;dbl&gt; 13, 42, 48, 49, 64, 74, 100, 124, 141, 173, 178, 219, 223…
## $ NDVI_BayArea &lt;dbl&gt; 0.24834478, 0.03120242, 0.21596712, 0.09975440, 0.5120553…</code></pre>
<p><br />
</p>
</div>
<div id="analyze-our-joined-dataset" class="section level1">
<h1>Analyze our Joined Dataset</h1>
<p>OK, we have a dataset with no missingness. Can we look at the
distribution of greenspace exposure among participants?</p>
<pre class="r"><code>ndvi_cancer_nomiss %&gt;%
  ggplot() + 
  geom_histogram(mapping = aes(x=NDVI_BayArea)) </code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Lab5_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><br />
</p>
<p>For the purposes of our analysis, let’s divide up our greenspace data
into quartiles. We will do this using the <code>mutate()</code> function
combined with the <code>ntile()</code> function. Then we will take a
glimpse at our new dataset.</p>
<pre class="r"><code>ndvi_cancer_nomiss &lt;- ndvi_cancer_nomiss %&gt;%
  mutate(ndvi_quartile = ntile(NDVI_BayArea, 4))

glimpse(ndvi_cancer_nomiss)</code></pre>
<pre><code>## Rows: 312
## Columns: 8
## $ time          &lt;dbl&gt; 7.0125318, 0.9644371, 15.0007229, 2.9063815, 16.7471545,…
## $ event         &lt;dbl&gt; 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1,…
## $ AGE           &lt;int&gt; 46, 69, 45, 78, 72, 73, 77, 72, 46, 61, 79, 54, 78, 60, …
## $ INS           &lt;fct&gt; Mcr, Unk, Mcd, Mcr, Mng, Mcr, Mng, Mcr, Oth, Uni, Mcr, U…
## $ geometry      &lt;POINT [°]&gt; POINT (-122.2031 38.09592), POINT (-122.416 37.767…
## $ ID            &lt;dbl&gt; 13, 42, 48, 49, 64, 74, 100, 124, 141, 173, 178, 219, 22…
## $ NDVI_BayArea  &lt;dbl&gt; 0.24834478, 0.03120242, 0.21596712, 0.09975440, 0.512055…
## $ ndvi_quartile &lt;int&gt; 3, 1, 2, 1, 4, 1, 3, 1, 4, 1, 1, 3, 3, 1, 3, 3, 1, 3, 4,…</code></pre>
<p><br />
</p>
<p>OK that looks good. We have created a new variable
<em>ndvi_quartile</em> that tells us what quartile of greenspace a
participant lives in. Let’s do a two by two table of greenspace
quartiles by <em>event</em>, which is whether a participant died over
followup.</p>
<pre class="r"><code>## Create a contingency table of event by walk_quartile
tab &lt;- table(ndvi_cancer_nomiss$ndvi_quartile, ndvi_cancer_nomiss$event)
tab</code></pre>
<pre><code>##    
##      0  1
##   1 36 42
##   2 37 41
##   3 32 46
##   4 31 47</code></pre>
<p><br />
</p>
<p>Hmmm, that’s interesting, but let’s look at this by percentages
instead.</p>
<pre class="r"><code>## Convert to percentages by column
tab_col_perc &lt;- prop.table(tab, margin = 2) * 100
round(tab_col_perc, 1)</code></pre>
<pre><code>##    
##        0    1
##   1 26.5 23.9
##   2 27.2 23.3
##   3 23.5 26.1
##   4 22.8 26.7</code></pre>
<p><br />
</p>
<p>Do you think the percentages are different by quartile of greenspace?
We can run a chi-squared test to be sure. This is a statistical test to
see whether there is a difference in the probability of <em>event</em>,
or whether a participant died over follow-up, by the quartiles of
greenspace We do this with the <code>chisq.test()</code> function.</p>
<pre class="r"><code>## Chi-squared test
chisq.test(tab)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tab
## X-squared = 1.3556, df = 3, p-value = 0.716</code></pre>
<p><br />
</p>
<p>OK, how do we interpret this? Our null hypothesis is that there is no
association between mortality at end of follow-up and increasing
quartile of greenspace. Our alternative hypothesis is that there is an
association between mortality at end of follow-up and increasing
quartile of greenspace. We use a two-sided chi-squared test with
alpha=0.05. Assuming no sources of bias and that the null hypothesis is
true, the probability of observing increases in mortality at end of
follow-up with increasing quartiles of greenspace as or more extreme as
those produced in these data is 0.716. Since p&gt;0.05, we fail to
reject the null hypothesis and conclude that greenspace is not
associated with mortality at end of follow-up (under the assumptions
stated above). In other words, we don’t see a relationship between
greenspace exposure and our outcome (dying over followup).</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAnTGFiIDU6IFNwYXRpYWwgRGF0YSBQcm9jZXNzaW5nIHdpdGggVmVjdG9yIGFuZCBSYXN0ZXIgRGF0YScKLS0tCgpcCgpJbiB0aGlzIGxhYiwgd2UgYXJlIGdvaW5nIHRvIHdvcmsgd2l0aCB2ZWN0b3IgYW5kIHJhc3RlciBkYXRhLCBzcGF0aWFsbHkgam9pbmluZyBwb2ludCBkYXRhIHRvIHZlY3RvciBkYXRhIAoKVGhlIG9iamVjdGl2ZXMgb2YgdGhpcyBndWlkZSBhcmUgdG8gdGVhY2ggeW91OgoKICAgMS4gSW1wb3J0IG91ciBkYXRhc2V0IHdpdGggc2ltdWxhdGVkIGdlb2NvZGVkIGFkZHJlc3NlcyBhbmQgbW9ydGFsaXR5IGRhdGEgZnJvbSBhbiBvdmFyaWFuIGNhbmNlciBjb2hvcnQKICAgMi4gSW1wb3J0IGEgZGF0YXNldCB3aXRoIGdyZWVuc3BhY2UgYWNyb3NzIHRoZSBCYXkgQXJlYQogICAzLiBDb21wYXJlIHByb2plY3Rpb25zIG9mIGRhdGFzZXRzIGFuZCByZS1wcm9qZWN0IGlmIG5lZWRlZAogICA0LiBNYWtlIG1hcHMKICAgNS4gU3BhdGlhbGx5IGpvaW4gdGhlIHR3byBkYXRhc2V0cwogICA2LiBSdW4gYSBxdWljayBzdGF0aXN0aWNhbCBhbmFseXNpcyBvbiB0aGUgdHdvIGRhdGFzZXRzIGNvbWJpbmVkCgpFbm91Z2ggdGFsay0tbGV0J3MgZ2V0IGNvZGluZyEKClwKCiMgSW5zdGFsbCBwYWNrYWdlcwoKRmlyc3QsIGxldCdzIGluc3RhbGwgb3VyIHBhY2thZ2VzLgpgYGB7cn0KbGlicmFyeShzZikKbGlicmFyeShNYXBHQU0pCmxpYnJhcnkodGlkeXZlcnNlKQpsaWJyYXJ5KGZsZXh0YWJsZSkKbGlicmFyeShSQ29sb3JCcmV3ZXIpCmxpYnJhcnkodG1hcCkKbGlicmFyeSh0ZXJyYSkKYGBgCgpcCgojIEJyaW5nIGluIENhbmNlciBkYXRhc2V0CgpXZSB3aWxsIGJlIHVzaW5nIGRhdGEgaW5jbHVkZWQgaW4gdGhlICoqTWFwR0FNKiogW3BhY2thZ2VdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9NYXBHQU0vTWFwR0FNLnBkZikuIEFzIGEgcmVtaW5kZXI6IFdoaWxlIHRoZXkgYXJlIGJhc2VkIG9uIHJlYWwgcGF0dGVybnMgZXhwZWN0ZWQgaW4gb2JzZXJ2YXRpb25hbCBlcGlkZW1pb2xvZ2ljIHN0dWRpZXMsIHRoZXNlIGRhdGEgaGF2ZSBiZWVuIHNpbXVsYXRlZCBhbmQgYXJlIGZvciB0ZWFjaGluZyBwdXJwb3NlcyBvbmx5LiBUaGUgZGF0YSBjb250YWluIDUwMDAgc2ltdWxhdGVkIG92YXJpYW4gY2FuY2VyIGNhc2VzLiBXaGlsZSB0aGlzIGlzIGEgY29ob3J0IHdpdGggdGltZSB0byBtb3J0YWxpdHksIGZvciB0aGUgcHVycG9zZXMgb2Ygb3VyIGNsYXNzLCB3ZSB3aWxsIGNvbmR1Y3Qgc2ltcGxlIHRhYnVsYXIgYW5hbHlzZXMgbG9va2luZyBhdCBhc3NvY2lhdGlvbnMgYmV0d2VlbiBkaWZmZXJlbnQgc3BhdGlhbCBleHBvc3VyZXMgd2l0aCBtb3J0YWxpdHkgYXQgZW5kIG9mIGZvbGxvdy11cC4gCgpBcyBhbm90aGVyIHJlbWluZGVyLCB0aGUgKkNBZGF0YSogZGF0YXNldCBjb250YWlucyB0aGUgZm9sbG93aW5nIHZhcmlhYmxlczoKCiogdGltZSAoZm9sbG93LXVwIHRpbWUpCiogZXZlbnQgKDE9ZGVhZCwgMD1jZW5zb3JlZCkKKiBYIChMYXRpdHVkZSkKKiBZIChMb25naXR1ZGUpCiogQUdFIChhZ2UgaW4geWVhcnMpCiogSU5TIChpbnN1cmFuY2Ugc3RhdHVzLCBjYXRlZ29yaWNhbCkKClwKCiMjIFJlYWQgaW4gQ2FuY2VyIERhdGFzZXQKCk5leHQsIHdlIHdhbnQgdG8gcmVhZCBpbiBhbGwgb2Ygb3VyIHNwYXRpYWwgZGF0YS4gRmlyc3QsIHdlIHJlYWQgaW4gdGhlICpDQWRhdGEqIGRhdGFzZXQgZnJvbSB0aGUgKipNYXBHQU0qKiBwYWNrYWdlLCBhbmQgdGhlbiBjb252ZXJ0IGl0IHRvIGEgc3BhdGlhbCBkYXRhc2V0LiAKCmBgYHtyfQpkYXRhKENBZGF0YSkKY2FfcHRzIDwtIENBZGF0YQpjYV9wcm9qIDwtICIrcHJvaj1sY2MgK2xhdF8xPTQwICtsYXRfMj00MS42NjY2NjY2NjY2NjY2NiAKICAgICAgICAgICAgICtsYXRfMD0zOS4zMzMzMzMzMzMzMzMzNCArbG9uXzA9LTEyMiAreF8wPTIwMDAwMDAgCiAgICAgICAgICAgICAreV8wPTUwMDAwMC4wMDAwMDAwMDAyICtlbGxwcz1HUlM4MCAKICAgICAgICAgICAgICtkYXR1bT1OQUQ4MyArdW5pdHM9bSArbm9fZGVmcyIKCmNhX3B0cyA8LSBzdF9hc19zZihDQWRhdGEsIGNvb3Jkcz1jKCJYIiwiWSIpLCBjcnM9Y2FfcHJvaikKYGBgCgpcCgojIyBSZWFkIGluIEdyZWVuc3BhY2UgRGF0YQoKV2UgdGhlbiByZWFkIGluIHRoZSByYXN0ZXIgZm9yIGdyZWVuc3BhY2UgZGF0YSBhY3Jvc3MgdGhlIEJheSBBcmVhLiBGaW5hbGx5LCB3ZSBjaGVjayB0aGUgZmlsZSB0byBtYWtlIHN1cmUgaXQgd2FzIHJlYWQgY29ycmVjdGx5LiBEb2VzIGl0IGhhdmUgYSBjb29yZGluYXRlIHJlZmVyZW5jZSBzeXN0ZW0/CgoKYGBge3J9CnVybCA8LSAiaHR0cHM6Ly9naXRodWIuY29tL3BqYW1lcy11Y2RhdmlzL1NQSDIxNS9yYXcvbWFpbi9ORFZJX3Jhc3QyLnRpZiIKZG93bmxvYWQuZmlsZSh1cmwsIGRlc3RmaWxlID0gIk5EVklfcmFzdDIudGlmIiwgbW9kZSA9ICJ3YiIpCm5kdmlfcmFzdCA9IHJhc3QoIk5EVklfcmFzdDIudGlmIikKCm5kdmlfcmFzdApgYGAKClwKCiMgQ2hlY2sgUHJvamVjdGlvbnMgZm9yIGFsbCBTcGF0aWFsIERhdGEKCkZpbmFsbHksIHdlIGNoZWNrIHRoZSBwcm9qZWN0aW9ucy4gKipUaGlzIGlzIHRoZSBtb3N0IGltcG9ydGFudCBzdGVwIGFuZCBpcyBndWFyYW50ZWVkIHRvIG1ha2UgbGlmZSBlYXNpZXIgd2l0aCB5b3VyIGdlb3NwYXRpYWwgYW5hbHlzaXMhKiogV2hlbiB5b3UgaGF2ZSBmaWxlcyBpbiBkaWZmZXJlbnQgcHJvamVjdGlvbnMsIHRoaXMgY2FuIGJlIGEgbWFqb3IgcHJvYmxlbSBiZWNhdXNlIHdoZW4gd2UgdHJ5IHRvIG92ZXJsYXkgdGhlIHR3byBmaWxlcyB0aGV5IG1heSBub3Qgb3ZlcmxhcC4gRmlyc3Qgd2UgY2hlY2sgdGhlIGNvb3JkaW5hdGUgcmVmZXJlbmNlIHN5c3RlbXMgZm9yIGVhY2ggZGF0YXNldCB1c2luZyBgc3RfY3JzKClgLiBXZSB0aGVuIHVzZSB0aGUgYHN0X3RyYW5zZm9ybSgpYCBmdW5jdGlvbiB0byBjb252ZXJ0IHRoZSBwcm9qZWN0aW9uIGZvciBvdXIgcG9pbnQgZGF0YSB0byBtYXRjaCB0aGF0IG9mIG91ciBwb2x5Z29uIGRhdGEuIFdoZW4gd2UgYXJlIGRvbmUsIGRvIHRoZSBwcm9qZWN0aW9ucyBvZiB0aGUgdHdvIGRhdGFzZXRzIG1hdGNoPwoKCmBgYHtyfQojIyBMb29rIGF0IHRoZSBjb29yZGluYXRlIHJlZmVyZW5jZSBzeXN0ZW0gZm9yIHRoZSBjYW5jZXIgZGF0YSwgYW5kIGZvciBncmVlbnNwYWNlIGRhdGEKc3RfY3JzKGNhX3B0cykKc3RfY3JzKG5kdmlfcmFzdCkKCiMjIFRyYW5zZm9ybSB0aGUgY29vcmRpbmF0ZSByZWZlcmVuY2Ugc3lzdGVtIG9mIHRoZSBjYW5jZXIgZGF0YSB0byBtYXRjaCB0aGF0IAojIyBvZiB0aGUgZ3JlZW5zcGFjZSAgZGF0YQpjYV90cmFuc2Zvcm1lZCA8LXN0X3RyYW5zZm9ybShjYV9wdHMsIHN0X2NycyhuZHZpX3Jhc3QpKSAgCgojIyBDaGVjayBwcm9qZWN0aW9ucwpzdF9jcnMobmR2aV9yYXN0KT09c3RfY3JzKGNhX3RyYW5zZm9ybWVkKQpgYGAKClwKCiMgTWFwIFRoZSBEYXRhCgpOb3csIHdlIHdpbGwgdmlzdWFsaXplIG91ciBzcGF0aWFsIGRhdGEgdXNpbmcgKip0bWFwKiouIFdlIHdpbGwgb3ZlcmxheSB0aGUgZ3JlZW5zcGFjZSBtYXBzIHdpdGggdGhlIG92YXJpYW4gY2FuY2VyIGRhdGEuIERvIGFueSBwYXR0ZXJucyBqdW1wIG91dCwgb3IgYXJlIHRoZXJlIGFueSBwYXJ0aWNpcGFudHMgbGl2aW5nIGluIHRoZSBtaWRkbGUgb2YgdGhlIEJheT8KCmBgYHtyfQpjYS5uZHZpLm1hcCA8LSB0bV9zaGFwZShuZHZpX3Jhc3QpICsKICB0bV9yYXN0ZXIoc3R5bGUgPSAiY29udCIpICsKICAgICAgdG1fc2hhcGUoY2FfdHJhbnNmb3JtZWQpICsKICAgICAgICB0bV9kb3RzKHNpemU9MC4yNSwgYWxwaGE9MC44LCBjb2w9ImJsdWUiKQpjYS5uZHZpLm1hcApgYGAKClwKCldlIGZpbmQgdGhhdCB0aGUgbW9zdCBsZWFzdCBncmVlbiBhcmVhcyBhcmUgaW4gdGhlIGRvd250b3duIGFyZWFzIG9mIFNhbiBGcmFuY2lzY28gYW5kIE9ha2xhbmQsIHdoaWNoIG1ha2VzIHNlbnNlLiBPdXIgY2FuY2VyIGNvaG9ydCBkYXRhIG92ZXJsYXBzIHdpdGggdGhlIGdyZWVuc3BhY2UgbWFwLCB3aGljaCBpcyByZWFzc3VyaW5nLiAKClwKCiMgRXh0cmFjdCBSYXN0ZXIgVmFsdWVzIHRvIFBvaW50cwoKTm93IHRoYXQgd2UgaGF2ZSB2aXN1YWxpemVkIG91ciBkYXRhLCBsZXQncyBzZWUgaWYgdGhlcmUgaXMgYW4gYXNzb2NpYXRpb24gYmV0d2VlbiBncmVlbnNwYWNlIGV4cG9zdXJlIGFuZCBtb3J0YWxpdHkgYW1vbmcgb3ZhcmlhbiBjYW5jZXIgY2FzZXMuIFdlIHdpbGwgZmlyc3QgZXh0cmFjdCB0aGUgdmFsdWVzIGZvciBncmVlbnNwYWNlIHRvIHRoZSBjYW5jZXIgZGF0YXNldCAobWVyZ2UgdGhlIHR3byBkYXRhc2V0cyBiYXNlZCBvbiBsb2NhdGlvbiBvZiBjYXNlcyBhbmQgdGhlIGdyZWVuc3BhY2UgcGl4ZWwgdGhhdCB0aGV5IGFyZSBpbikgdXNpbmcgYHRlcnJhOjpleHRyYWN0YC4gVGhlbiB3ZSB3aWxsIGNoZWNrIHRoZSBkaXN0cmlidXRpb24gb2YgZ3JlZW5zcGFjZSBleHBvc3VyZSBpbiBvdXIgY2FuY2VyIGNhc2VzLiBXZSB3aWxsIHVzZSBhIHR3by1zaWRlZCBjaGktc3F1YXJlZCB0ZXN0IHRvIHRlc3Qgb3VyIGh5cG90aGVzaXMgb2YgdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gZ3JlZW5zcGFjZSBleHBvc3VyZSBhbmQgbW9ydGFsaXR5IGFtb25nIG92YXJpYW4gY2FuY2VyIGNhc2VzLiBXaGF0IGRvIHdlIGZpbmQ/CgpgYGB7cn0KIyMgU3BhdGlhbGx5IGpvaW4gdGhlIGNhbmNlciBwb2ludCBkYXRhIHRvIHRoZSB3YWxrYWJpbGl0eSBwb2x5Z29uIGRhdGEKbmR2aV9jYW5jZXIgPSBkYXRhLmZyYW1lKGNhX3RyYW5zZm9ybWVkLHRlcnJhOjpleHRyYWN0KG5kdmlfcmFzdCwgY2FfdHJhbnNmb3JtZWQpKQpnbGltcHNlKG5kdmlfY2FuY2VyKSAKIyMgVGFrZSBhIGxvb2sgYXQgYSBzdW1tYXJ5IG9mIHRoZSB2YWx1ZXMKc3VtbWFyeShuZHZpX2NhbmNlciRORFZJX0JheUFyZWEpCmBgYAoKXAoKTG9va3MgbGlrZSB3ZSBoYXZlIGxvdHMgb2YgTkEgdmFsdWVzLiBUaGF0IGlzIGJlY2F1c2Ugc29tZSBvZiBvdXIgcGFydGljaXBhbnRzIGxpdmUgb3V0c2lkZSBvZiB0aGUgYXJlYSBvZiBvdXIgZ3JlZW5zcGFjZSBkYXRhLiBMZXQncyBkcm9wIHRob3NlIG1pc3NpbmcgdmFsdWVzIHVzaW5nIGBkcm9wX25hKClgLCB3aGljaCBpcyBzbGlnaHRseSBkaWZmZXJlbnQgZnJvbSBob3cgd2UndmUgZG9uZSB0aGlzIGJlZm9yZS4KCmBgYHtyfQpuZHZpX2NhbmNlcl9ub21pc3MgPC0gbmR2aV9jYW5jZXIgJT4lIGRyb3BfbmEoTkRWSV9CYXlBcmVhKSAKCiMjIFRha2UgYSBsb29rIGF0IGEgc3VtbWFyeSBvZiB0aGUgdmFsdWVzCnN1bW1hcnkobmR2aV9jYW5jZXJfbm9taXNzJE5EVklfQmF5QXJlYSkKZ2xpbXBzZShuZHZpX2NhbmNlcl9ub21pc3MpCmBgYAoKXAoKIyBBbmFseXplIG91ciBKb2luZWQgRGF0YXNldApPSywgd2UgaGF2ZSBhIGRhdGFzZXQgd2l0aCBubyBtaXNzaW5nbmVzcy4gQ2FuIHdlIGxvb2sgYXQgdGhlIGRpc3RyaWJ1dGlvbiBvZiBncmVlbnNwYWNlIGV4cG9zdXJlIGFtb25nIHBhcnRpY2lwYW50cz8KYGBge3J9Cm5kdmlfY2FuY2VyX25vbWlzcyAlPiUKICBnZ3Bsb3QoKSArIAogIGdlb21faGlzdG9ncmFtKG1hcHBpbmcgPSBhZXMoeD1ORFZJX0JheUFyZWEpKSAKCmBgYAoKXAoKRm9yIHRoZSBwdXJwb3NlcyBvZiBvdXIgYW5hbHlzaXMsIGxldCdzIGRpdmlkZSB1cCBvdXIgZ3JlZW5zcGFjZSBkYXRhIGludG8gcXVhcnRpbGVzLiBXZSB3aWxsIGRvIHRoaXMgdXNpbmcgdGhlIGBtdXRhdGUoKWAgZnVuY3Rpb24gY29tYmluZWQgd2l0aCB0aGUgYG50aWxlKClgIGZ1bmN0aW9uLiBUaGVuIHdlIHdpbGwgdGFrZSBhIGdsaW1wc2UgYXQgb3VyIG5ldyBkYXRhc2V0LgoKYGBge3J9Cm5kdmlfY2FuY2VyX25vbWlzcyA8LSBuZHZpX2NhbmNlcl9ub21pc3MgJT4lCiAgbXV0YXRlKG5kdmlfcXVhcnRpbGUgPSBudGlsZShORFZJX0JheUFyZWEsIDQpKQoKZ2xpbXBzZShuZHZpX2NhbmNlcl9ub21pc3MpCmBgYAoKXAoKT0sgdGhhdCBsb29rcyBnb29kLiBXZSBoYXZlIGNyZWF0ZWQgYSBuZXcgdmFyaWFibGUgKm5kdmlfcXVhcnRpbGUqIHRoYXQgdGVsbHMgdXMgd2hhdCBxdWFydGlsZSBvZiBncmVlbnNwYWNlIGEgcGFydGljaXBhbnQgbGl2ZXMgaW4uIExldCdzIGRvIGEgdHdvIGJ5IHR3byB0YWJsZSBvZiBncmVlbnNwYWNlIHF1YXJ0aWxlcyBieSAqZXZlbnQqLCB3aGljaCBpcyB3aGV0aGVyIGEgcGFydGljaXBhbnQgZGllZCBvdmVyIGZvbGxvd3VwLgpgYGB7cn0KIyMgQ3JlYXRlIGEgY29udGluZ2VuY3kgdGFibGUgb2YgZXZlbnQgYnkgd2Fsa19xdWFydGlsZQp0YWIgPC0gdGFibGUobmR2aV9jYW5jZXJfbm9taXNzJG5kdmlfcXVhcnRpbGUsIG5kdmlfY2FuY2VyX25vbWlzcyRldmVudCkKdGFiCmBgYAoKXAoKSG1tbSwgdGhhdCdzIGludGVyZXN0aW5nLCBidXQgbGV0J3MgbG9vayBhdCB0aGlzIGJ5IHBlcmNlbnRhZ2VzIGluc3RlYWQuCmBgYHtyfQojIyBDb252ZXJ0IHRvIHBlcmNlbnRhZ2VzIGJ5IGNvbHVtbgp0YWJfY29sX3BlcmMgPC0gcHJvcC50YWJsZSh0YWIsIG1hcmdpbiA9IDIpICogMTAwCnJvdW5kKHRhYl9jb2xfcGVyYywgMSkKYGBgCgpcCgpEbyB5b3UgdGhpbmsgdGhlIHBlcmNlbnRhZ2VzIGFyZSBkaWZmZXJlbnQgYnkgcXVhcnRpbGUgb2YgZ3JlZW5zcGFjZT8gV2UgY2FuIHJ1biBhIGNoaS1zcXVhcmVkIHRlc3QgdG8gYmUgc3VyZS4gVGhpcyBpcyBhIHN0YXRpc3RpY2FsIHRlc3QgdG8gc2VlIHdoZXRoZXIgdGhlcmUgaXMgYSBkaWZmZXJlbmNlIGluIHRoZSBwcm9iYWJpbGl0eSBvZiAqZXZlbnQqLCBvciB3aGV0aGVyIGEgcGFydGljaXBhbnQgZGllZCBvdmVyIGZvbGxvdy11cCwgYnkgdGhlIHF1YXJ0aWxlcyBvZiBncmVlbnNwYWNlIFdlIGRvIHRoaXMgd2l0aCB0aGUgYGNoaXNxLnRlc3QoKWAgZnVuY3Rpb24uCmBgYHtyfQojIyBDaGktc3F1YXJlZCB0ZXN0CmNoaXNxLnRlc3QodGFiKQpgYGAKClwKCk9LLCBob3cgZG8gd2UgaW50ZXJwcmV0IHRoaXM/IE91ciBudWxsIGh5cG90aGVzaXMgaXMgdGhhdCB0aGVyZSBpcyBubyBhc3NvY2lhdGlvbiBiZXR3ZWVuIG1vcnRhbGl0eSBhdCBlbmQgb2YgZm9sbG93LXVwIGFuZCBpbmNyZWFzaW5nIHF1YXJ0aWxlIG9mIGdyZWVuc3BhY2UuIE91ciBhbHRlcm5hdGl2ZSBoeXBvdGhlc2lzIGlzIHRoYXQgdGhlcmUgaXMgYW4gYXNzb2NpYXRpb24gYmV0d2VlbiBtb3J0YWxpdHkgYXQgZW5kIG9mIGZvbGxvdy11cCBhbmQgaW5jcmVhc2luZyBxdWFydGlsZSBvZiBncmVlbnNwYWNlLiBXZSB1c2UgYSB0d28tc2lkZWQgY2hpLXNxdWFyZWQgdGVzdCB3aXRoIGFscGhhPTAuMDUuIEFzc3VtaW5nIG5vIHNvdXJjZXMgb2YgYmlhcyBhbmQgdGhhdCB0aGUgbnVsbCBoeXBvdGhlc2lzIGlzIHRydWUsIHRoZSBwcm9iYWJpbGl0eSBvZiBvYnNlcnZpbmcgaW5jcmVhc2VzIGluIG1vcnRhbGl0eSBhdCBlbmQgb2YgZm9sbG93LXVwIHdpdGggaW5jcmVhc2luZyBxdWFydGlsZXMgb2YgZ3JlZW5zcGFjZSBhcyBvciBtb3JlIGV4dHJlbWUgYXMgdGhvc2UgcHJvZHVjZWQgaW4gdGhlc2UgZGF0YSBpcyAwLjcxNi4gU2luY2UgcD4wLjA1LCB3ZSBmYWlsIHRvIHJlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzIGFuZCBjb25jbHVkZSB0aGF0IGdyZWVuc3BhY2UgaXMgbm90IGFzc29jaWF0ZWQgd2l0aCBtb3J0YWxpdHkgYXQgZW5kIG9mIGZvbGxvdy11cCAodW5kZXIgdGhlIGFzc3VtcHRpb25zIHN0YXRlZCBhYm92ZSkuIEluIG90aGVyIHdvcmRzLCB3ZSBkb24ndCBzZWUgYSByZWxhdGlvbnNoaXAgYmV0d2VlbiBncmVlbnNwYWNlIGV4cG9zdXJlIGFuZCBvdXIgb3V0Y29tZSAoZHlpbmcgb3ZlciBmb2xsb3d1cCkuCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Lab5.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
